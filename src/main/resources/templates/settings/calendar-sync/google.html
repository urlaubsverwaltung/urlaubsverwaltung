<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <title></title>
  </head>
  <body>
    <th:block th:fragment="section">
      <div class="uv-form__group">
        <div class="uv-form__info">
          <p th:text="#{settings.calendar.google.description}"></p>

          <p>
            <span th:text="#{settings.calendar.google.description.help}"></span>
            <a
              target="_blank"
              rel="noopener"
              href="https://urlaubsverwaltung.cloud/hilfe/urlaubsverwaltung/kalender/#google-calendar"
              th:text="#{settings.calendar.google.description.help.link-text}"
            >
              Hilfe
            </a>
          </p>

          <dl class="tw-mt-4">
            <dt class="tw-mb-0.5 tw-flex tw-items-center tw-gap-2">
              <svg th:replace="~{icon/info::svg(className='tw-w-4 tw-h-4')}"></svg>
              <th:block th:text="#{settings.calendar.google.oauth-client-id.title}"></th:block>
            </dt>
            <dd th:utext="#{settings.calendar.google.oauth-client-id.description}"></dd>
            <dt class="tw-mb-0.5 tw-mt-4 tw-flex tw-items-center tw-gap-2">
              <svg th:replace="~{icon/info::svg(className='tw-w-4 tw-h-4')}"></svg>
              <th:block th:text="#{settings.calendar.google.oauth-client-secret.title}"></th:block>
            </dt>
            <dd th:text="#{settings.calendar.google.oauth-client-secret.description}"></dd>
            <dt class="tw-mb-0.5 tw-mt-4 tw-flex tw-items-center tw-gap-2">
              <svg th:replace="~{icon/info::svg(className='tw-w-4 tw-h-4')}"></svg>
              <th:block th:text="#{settings.calendar.google.calendar-id.title}"></th:block>
            </dt>
            <dd th:text="#{settings.calendar.google.calendar-id.description}"></dd>
            <dt class="tw-mb-0.5 tw-mt-4 tw-flex tw-items-center tw-gap-2">
              <svg th:replace="~{icon/info::svg(className='tw-w-4 tw-h-4')}"></svg>
              <th:block th:text="#{settings.calendar.google.redirect-url.title}"></th:block>
            </dt>
            <dd th:text="#{settings.calendar.google.redirect-url.description}"></dd>
          </dl>
        </div>

        <!-- Client ID Settings -->
        <div class="uv-form__input-row">
          <label
            th:text="|#{settings.calendar.google.clientid}:|"
            for="calendarSettings.googleCalendarSettings.clientId"
          >
            OAuth2 Client ID
          </label>
          <div>
            <input
              id="calendarSettings.googleCalendarSettings.clientId"
              th:field="*{calendarSettings.googleCalendarSettings.clientId}"
              class="form-control"
              th:errorclass="error"
            />
            <p
              class="tw-text-sm tw-text-red-800 dark:tw-text-red-400"
              th:if="${#fields.hasErrors('calendarSettings.googleCalendarSettings.clientId')}"
            >
              <th:block th:errors="*{calendarSettings.googleCalendarSettings.clientId}">
                calendarSettings.googleCalendarSettings.clientId Error
              </th:block>
            </p>
          </div>
        </div>

        <!-- Client Secret Settings -->
        <div class="uv-form__input-row">
          <label
            th:text="|#{settings.calendar.google.clientsecret}:|"
            for="calendarSettings.googleCalendarSettings.clientSecret"
          >
            OAuth2 Client Secret
          </label>
          <div>
            <input
              id="calendarSettings.googleCalendarSettings.clientSecret"
              th:field="*{calendarSettings.googleCalendarSettings.clientSecret}"
              class="form-control"
              th:errorclass="error"
            />
            <p
              class="tw-text-sm tw-text-red-800 dark:tw-text-red-400"
              th:if="${#fields.hasErrors('calendarSettings.googleCalendarSettings.clientSecret')}"
            >
              <th:block th:errors="*{calendarSettings.googleCalendarSettings.clientSecret}">
                calendarSettings.googleCalendarSettings.clientSecret Error
              </th:block>
            </p>
          </div>
        </div>

        <!-- Calendar ID Settings -->
        <div class="uv-form__input-row">
          <label
            th:text="|#{settings.calendar.google.calendarid}:|"
            for="calendarSettings.googleCalendarSettings.calendarId"
          >
            Kalender ID
          </label>
          <div>
            <input
              id="calendarSettings.googleCalendarSettings.calendarId"
              th:field="*{calendarSettings.googleCalendarSettings.calendarId}"
              class="form-control"
              th:errorclass="error"
            />
            <p
              class="tw-text-sm tw-text-red-800 dark:tw-text-red-400"
              th:if="${#fields.hasErrors('calendarSettings.googleCalendarSettings.calendarId')}"
            >
              <th:block th:errors="*{calendarSettings.googleCalendarSettings.calendarId}">
                calendarSettings.googleCalendarSettings.calendarId Error
              </th:block>
            </p>
          </div>
        </div>

        <!-- Redirect URL (readonly) -->
        <div class="uv-form__input-row">
          <label for="redirecturl-input" th:text="|#{settings.calendar.google.redirecturl}:|">
            Weiterleitungs-URL
          </label>
          <input
            id="redirecturl-input"
            class="form-control"
            type="text"
            name="calendarSettings.googleCalendarSettings.authorizedRedirectUrl"
            th:value="${authorizedRedirectUrl}"
            readonly
          />
        </div>

        <!-- OAuth Button / Status Message -->
        <div class="uv-form__input-row">
          <div style="grid-column: input">
            <p
              th:if="${not #strings.isEmpty(oautherrors)}"
              th:text="${oautherrors}"
              class="tw-text-red-600 tw-mb-4"
            ></p>
            <th:block th:if="${settings.calendarSettings.googleCalendarSettings.refreshToken == null}">
              <div class="tw-flex tw-flex-row">
                <p
                  th:text="#{settings.calendar.google.action.authenticate.description}"
                  class="tw-text-red-600 tw-w-2/3"
                ></p>
                <button
                  th:text="#{settings.calendar.google.action.authenticate}"
                  id="googleOAuthButton"
                  value="oauth"
                  name="googleOAuthButton"
                  type="submit"
                  class="button-main tw-w-1/3"
                ></button>
              </div>
            </th:block>
            <th:block th:if="${settings.calendarSettings.googleCalendarSettings.refreshToken != null}">
              <p th:text="#{settings.calendar.google.action.authenticate.success}" class="tw-text-green-600"></p>
            </th:block>
          </div>
        </div>
      </div>
    </th:block>
  </body>
</html>
