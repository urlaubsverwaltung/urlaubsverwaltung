<!doctype html>
<html lang="en" th:lang="${language}" th:class="|theme-${theme}|" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{_layout::head(title=~{::title}, scriptsDefer=~{::scriptsDefer}, preload=~{::preload})}">
    <title th:text="#{person.account.header.title(${person.niceName})}"></title>
    <th:block th:fragment="preload">
      <link rel="preload" th:replace="~{fragments/asset-dependency-preload::links('person.js')}" />
    </th:block>
    <th:block th:ref="scriptsDefer">
      <script defer type="module" asset:src="person.js"></script>
    </th:block>
  </head>
  <body th:replace="~{_layout::body(~{::main}, ~{})}">
    <main th:fragment="main">
      <div class="max-w-6xl mx-auto px-4 lg:px-12 xl:px-1.5">
        <div class="feedback">
          <p th:if="${createSuccess}" th:text="#{person.account.action.create.success}" class="alert alert-success"></p>
          <p th:if="${updateSuccess}" th:text="#{person.account.action.update.success}" class="alert alert-success"></p>
        </div>

        <div class="space-y-12 md:space-y-0 md:grid gap-12 grid-cols-1 md:grid-cols-2">
          <div class="md:col-start-1 md:row-start-1">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-basedata-body}, ~{::person-details-basedata-actions})}"
            >
              <th:block th:ref="person-details-basedata-body">
                <h2 th:text="#{person.account.basedata.title}">Stammdaten</h2>
              </th:block>
              <th:block th:ref="person-details-basedata-actions">
                <a
                  th:if="${canEditBasedata}"
                  th:href="@{/web/person/__${person.id}__/basedata}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-basedata-box-icon}, ~{::person-details-basedata-box-body})}"
            >
              <th:block th:ref="person-details-basedata-box-icon">
                <span class="text-blue-50 dark:text-sky-800">
                  <img
                    th:replace="~{fragments/avatar::avatar-bordered(url=${person.gravatarURL + '?d=404&s=60'},niceName=${person.niceName},initials=${person.initials},width='60',height='60',personId=${person.id})}"
                    alt=""
                  />
                </span>
              </th:block>
              <th:block th:ref="person-details-basedata-box-body">
                <span class="flex items-center mb-1 mt-2">
                  <a
                    th:text="${person.niceName}"
                    th:href="@{/web/person/__${person.id}__/overview}"
                    class="text-lg text-link"
                  ></a>
                  <th:block th:if="${person.isInactive}">
                    <span
                      class="flex items-center text-zinc-700 dark:text-zinc-50/75"
                      th:data-title="#{person.data.inactive}"
                    >
                      &nbsp;<svg th:replace="~{icon/user-x::svg(className='w-4 h-4')}" />
                      <span class="sr-only">(<th:block th:text="#{person.data.inactive}" />)</span>
                    </span>
                  </th:block>
                </span>
                <a th:if="${person.email != null}" th:href="|mailto:${person.email}|" class="icon-link text-sm">
                  <svg th:replace="~{icon/mail::svg(className='w-4 h-4')}"></svg>&nbsp;
                  <th:block th:text="${person.email}" />
                </a>
                <span
                  th:if="${person.email == null}"
                  class="text-sm"
                  th:text="#{person.account.basedata.email.notification(${person.niceName})}"
                ></span>
                <dl class="mt-4">
                  <dt
                    th:if="${personBasedata != null && not #strings.isEmpty(personBasedata.personnelNumber)}"
                    th:text="#{person.account.basedata.personnelNumber}"
                    class="mb-2 font-medium dark:text-zinc-400"
                  ></dt>
                  <dd
                    th:if="${personBasedata != null && not #strings.isEmpty(personBasedata.personnelNumber)}"
                    th:text="${personBasedata.personnelNumber}"
                    class="text-sm text-ellipsis overflow-hidden"
                  ></dd>
                  <dt
                    th:if="${personBasedata != null && not #strings.isEmpty(personBasedata.additionalInformation)}"
                    th:text="#{person.account.basedata.additionalInformation}"
                    class="mb-2 mt-4 font-medium dark:text-zinc-400"
                  ></dt>
                  <dd
                    th:if="${personBasedata != null && not #strings.isEmpty(personBasedata.additionalInformation)}"
                    class="text-sm text-ellipsis overflow-hidden"
                  >
                    <span th:text="${personBasedata.additionalInformation}" class="whitespace-pre-line"></span>
                  </dd>
                </dl>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-1 md:row-start-2">
            <div th:replace="~{fragments/section-heading::section-heading(~{::person-details-departments-body}, ~{})}">
              <th:block th:ref="person-details-departments-body">
                <h2 th:text="#{person.account.departments.title}">Abteilungen</h2>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-departments-box-icon}, ~{::person-details-departments-box-body})}"
            >
              <th:block th:ref="person-details-departments-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-departments-box-icon-rounded}, className='bg-blue-400 text-white dark:bg-sky-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-departments-box-icon-rounded">
                    <svg th:replace="~{icon/users::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-departments-box-body">
                <th:block
                  th:if="${#lists.isEmpty(departments)}"
                  th:text="#{person.account.departments.none}"
                ></th:block>
                <ul
                  th:if="${not #lists.isEmpty(departments)}"
                  th:each="department : ${departments}"
                  class="space-y-0.5 text-sm"
                >
                  <li
                    th:if="${#lists.contains(departmentHeadOfDepartments, department) && #lists.contains(secondStageAuthorityOfDepartments, department)}"
                  >
                    <a
                      th:if="${canEditDepartments}"
                      th:text="${department.name}"
                      th:href="@{/web/department/__${department.id}__/edit}"
                    ></a>
                    <th:block th:unless="${canEditDepartments}" th:text="${department.name}" />
                    <th:block th:text="#{person.account.departments.departmentHeadAndSecondStageAuthority}" />
                  </li>
                  <li
                    th:if="${#lists.contains(departmentHeadOfDepartments, department) && !#lists.contains(secondStageAuthorityOfDepartments, department)}"
                  >
                    <a
                      th:if="${canEditDepartments}"
                      th:text="${department.name}"
                      th:href="@{/web/department/__${department.id}__/edit}"
                    ></a>
                    <th:block th:unless="${canEditDepartments}" th:text="${department.name}" />
                    <th:block th:text="#{person.account.departments.departmentHead}" />
                  </li>
                  <li
                    th:if="${!#lists.contains(departmentHeadOfDepartments, department) && #lists.contains(secondStageAuthorityOfDepartments, department)}"
                  >
                    <a
                      th:if="${canEditDepartments}"
                      th:text="${department.name}"
                      th:href="@{/web/department/__${department.id}__/edit}"
                    ></a>
                    <th:block th:unless="${canEditDepartments}" th:text="${department.name}" />
                    <th:block th:text="#{person.account.departments.secondStageAuthority}" />
                  </li>
                  <li
                    th:if="${not #lists.contains(departmentHeadOfDepartments, department) && not #lists.contains(secondStageAuthorityOfDepartments, department)}"
                  >
                    <a
                      th:if="${canEditDepartments}"
                      th:text="${department.name}"
                      th:href="@{/web/department/__${department.id}__/edit}"
                    ></a>
                    <th:block th:unless="${canEditDepartments}" th:text="${department.name}" />
                  </li>
                </ul>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-1 md:row-start-3">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-permissions-body}, ~{::person-details-permissions-actions})}"
            >
              <th:block th:ref="person-details-permissions-body">
                <h2 th:text="#{person.account.permissions.title}">Berechtigungen</h2>
              </th:block>
              <th:block th:ref="person-details-permissions-actions">
                <a
                  th:if="${canEditPermissions}"
                  th:href="@{/web/person/__${person.id}__/permissions}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-permissions-box-icon}, ~{::person-details-permissions-box-body})}"
            >
              <th:block th:ref="person-details-permissions-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-permissions-box-icon-rounded}, className='bg-blue-400 text-white dark:bg-sky-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-permissions-box-icon-rounded">
                    <svg th:replace="~{icon/key::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-permissions-box-body">
                <dl th:each="role, loop : ${permissions}">
                  <dt
                    th:with="permissionMessageKey=|person.form.permissions.roles.${role}|"
                    th:text="#{__${permissionMessageKey}__}"
                    class="mb-2 font-medium"
                  ></dt>
                  <dd
                    th:text="#{'person.form.permissions.roles.' + ${role} + '.description'(${person.niceName})}"
                    th:class="|text-sm ${not loop.last ? 'mb-8' : ''}|"
                  ></dd>
                </dl>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-1 md:row-start-4">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-notifications-body}, ~{::person-details-notifications-actions})}"
            >
              <th:block th:ref="person-details-notifications-body">
                <h2 id="heading-notification" th:text="#{person.account.notifications.title}">Benachrichtigungen</h2>
              </th:block>
              <th:block th:ref="person-details-notifications-actions">
                <a
                  th:if="${canEditNotifications}"
                  th:href="@{/web/person/__${person.id}__/notifications}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-notifications-box-icon}, ~{::person-details-notifications-box-body})}"
            >
              <th:block th:ref="person-details-notifications-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-notifications-box-icon-rounded}, className='bg-blue-400 text-white dark:bg-sky-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-notifications-box-icon-rounded">
                    <svg th:replace="~{icon/mail::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-notifications-box-body">
                <th:block
                  th:replace="~{person/detail-section/person_detail_notifications::section(${personNotificationsDto})}"
                ></th:block>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-2 md:row-start-1">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-account-body}, ~{::person-details-account-actions})}"
            >
              <th:block th:ref="person-details-account-body">
                <h2 th:text="#{person.account.annualVacation.title}">Urlaubsanspruch</h2>
                <div
                  th:replace="~{fragments/year-selector::year-selector(id='year-selection', currentYear=${currentYear}, hrefPrefix=|/web/person/${person.id}?year=|, selectedYear=${selectedYear})}"
                ></div>
              </th:block>
              <th:block th:ref="person-details-account-actions">
                <a
                  th:if="${canEditAccounts}"
                  th:href="@{/web/person/__${person.id}__/account?year=__${selectedYear}__}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-account-box-icon}, ~{::person-details-account-box-body})}"
            >
              <th:block th:ref="person-details-account-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-account-box-icon-rounded}, className='bg-emerald-500 text-white dark:bg-green-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-account-box-icon-rounded">
                    <svg th:replace="~{icon/calendar::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-account-box-body">
                <th:block th:if="${account != null}">
                  <span
                    th:text="#{person.account.vacation.entitlement.1}"
                    class="text-sm text-black/75 dark:text-zinc-300"
                  >
                  </span>
                  <span
                    th:text="#{person.account.vacation.entitlement.2(${account.actualVacationDays + account.remainingVacationDays})}"
                    class="my-1 text-lg font-medium"
                  >
                  </span>
                  <span
                    th:text="#{person.account.vacation.entitlement.remaining(${account.remainingVacationDays})}"
                    class="text-sm text-black/75 dark:text-zinc-300"
                  >
                  </span>
                  <span
                    th:if="${not account.doRemainingVacationDaysExpire}"
                    th:text="#{person.account.vacation.entitlement.remaining.doNotExpire}"
                    class="mt-2 text-sm text-black/75 dark:text-zinc-300"
                  ></span>
                  <span
                    th:if="${account.doRemainingVacationDaysExpire}"
                    class="text-sm text-black/75 dark:text-zinc-300"
                  >
                    <th:block
                      th:text="#{person.account.vacation.entitlement.remaining.notExpiring.one(${account.remainingVacationDaysNotExpiring})}"
                    ></th:block>
                    <th:block th:replace="~{fragments/date::date(${account.expiryDate})}"></th:block>
                    <th:block
                      th:text="#{person.account.vacation.entitlement.remaining.notExpiring.two(${account.remainingVacationDaysNotExpiring})}"
                    ></th:block>
                  </span>
                </th:block>
                <th:block th:if="${account == null}">
                  <span th:text="#{person.account.vacation.noInformation}" class="text-sm"></span>
                </th:block>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-2 md:row-start-3">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-workingtime-body}, ~{::person-details-workingtime-actions})}"
            >
              <th:block th:ref="person-details-workingtime-body">
                <h2 th:text="#{person.account.workingTime.title}">Arbeitszeiten</h2>
              </th:block>
              <th:block th:ref="person-details-workingtime-actions">
                <a
                  th:if="${canEditWorkingtime}"
                  th:href="@{/web/person/__${person.id}__/workingtime}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-workingtime-box-icon}, ~{::person-details-workingtime-box-body})}"
            >
              <th:block th:ref="person-details-workingtime-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-workingtime-box-icon-rounded}, className='bg-emerald-500 text-white dark:bg-green-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-workingtime-box-icon-rounded">
                    <svg th:replace="~{icon/clock::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-workingtime-box-body">
                <span class="text-sm">
                  <th:block th:if="${workingTime != null}">
                    <p class="mb-2">
                      <th:block th:text="#{person.account.workingTime.validity}" />
                      <span class="is-inline-block">
                        <th:block th:replace="~{fragments/date::date(${workingTime.validFrom})}"></th:block> </span
                      >:
                    </p>
                    <table class="flex">
                      <caption th:text="#{person.account.workingTime.title}" class="sr-only"></caption>
                      <thead class="order-last">
                        <tr>
                          <th th:text="#{MONDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{TUESDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{WEDNESDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{THURSDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{FRIDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{SATURDAY}" class="block text-sm font-medium" scope="col"></th>
                          <th th:text="#{SUNDAY}" class="block text-sm font-medium" scope="col"></th>
                        </tr>
                      </thead>
                      <tbody class="mr-1 flex">
                        <tr class="flex flex-col">
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.monday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.monday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.tuesday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.tuesday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.wednesday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.wednesday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.thursday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.thursday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.friday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.friday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.saturday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.saturday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                          <td class="flex-1 flex items-center py-0.5">
                            <th:block th:if="${workingTime.sunday.duration > 0}">
                              <svg th:replace="~{icon/check-circle-2::svg(className='w-4 h-4')}" />
                            </th:block>
                            <span
                              th:text="#{${workingTime.sunday.duration > 0 ? 'person.workingday.yes' : 'person.workingday.no'}}"
                              class="sr-only"
                            ></span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </th:block>
                  <th:block th:if="${workingTime == null}">
                    <th:block th:text="#{person.account.workingTime.none}"></th:block>
                  </th:block>
                </span>
              </th:block>
            </div>
          </div>

          <div class="md:col-start-2 md:row-start-2">
            <div
              th:replace="~{fragments/section-heading::section-heading(~{::person-details-federalState-body}, ~{::person-details-federalState-actions})}"
            >
              <th:block th:ref="person-details-federalState-body">
                <h2 th:text="#{person.account.federalState.title}">Feiertagsregelung</h2>
              </th:block>
              <th:block th:ref="person-details-federalState-actions">
                <a
                  th:if="${canEditWorkingtime}"
                  th:href="@{/web/person/__${person.id}__/workingtime}"
                  class="icon-link"
                  aria-hidden="true"
                >
                  <svg th:replace="~{icon/pencil::svg(className='w-5 h-5')}"></svg>&nbsp;
                  <span th:text="#{action.edit}"></span>
                </a>
              </th:block>
            </div>
            <div
              th:replace="~{fragments/box::box-with-icon(~{::person-details-federalstate-box-icon}, ~{::person-details-federalstate-box-body})}"
            >
              <th:block th:ref="person-details-federalstate-box-icon">
                <div
                  th:replace="~{fragments/rounded::block(content=~{::person-details-federalstate-box-icon-rounded}, className='bg-emerald-500 text-white dark:bg-green-500 dark:text-zinc-900')}"
                >
                  <th:block th:ref="person-details-federalstate-box-icon-rounded">
                    <svg th:replace="~{icon/map::svg(className='w-8 h-8')}" />
                  </th:block>
                </div>
              </th:block>
              <th:block th:ref="person-details-federalstate-box-body">
                <span
                  th:if="${federalState.name == 'NONE'}"
                  th:text="#{federalState.NONE}"
                  class="text-base font-medium"
                ></span>
                <p th:if="${federalState.name != 'NONE'}">
                  <span th:text="#{person.account.workingTime.federalState}" class="block mb-1 text-sm"></span>
                  <span
                    th:with="countryCode=|country.${federalState.country}|,federalStateCode=|federalState.${federalState}|"
                    class="text-base font-medium"
                  >
                    <th:block th:text="#{__${countryCode}__}"></th:block> -
                    <th:block th:text="#{__${federalStateCode}__}"></th:block>
                  </span>
                </p>
              </th:block>
            </div>
          </div>

          <div th:if="${canDeletePerson}" class="md:col-start-2 md:row-start-4">
            <th:block th:replace="~{person/detail-section/action-delete-person::section}"></th:block>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
